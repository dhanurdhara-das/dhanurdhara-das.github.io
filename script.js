// Translations
const translations = {
    en: {
        lang: {
            english: 'English',
            portuguese: 'Português'
        },
        nav: {
            logo: 'Wellness Center',
            home: 'Home',
            about: 'Bhakti Marga',
            satguru: 'Satguru',
            bio: 'Bio',
            practices: 'Practices',
            contact: 'Contact'
        },
        home: {
            heroTitle: 'Dhanurdhara Das Ananda',
            heroSubtitle: 'Your journey to wellness begins here',
            getStarted: 'Get Started',
            feature1Title: 'Holistic Approach',
            feature1Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore.',
            feature2Title: 'Natural Methods',
            feature2Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore.',
            feature3Title: 'Expert Care',
            feature3Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore.'
        },
        about: {
            title: 'Bhakti Marga',
            storyTitle: 'Our Story',
            story1: 'Bhakti Marga began in 2005 as a small devotional community dedicated to cultivating a life rooted in love, service, and spiritual practice. Over the years it has grown into a global movement with centres, temples, and ashrams across Europe, the Americas, Africa, and Asia. Its international headquarters, Shree Peetha Nilaya in Germany, serves as the main ashram and training hub. Additional temples and ashrams operate in countries such as Portugal, the UK, France, South Africa, Mauritius, India, the USA, and Brazil, each offering regular community gatherings and devotional programs.\n\nThe path is grounded in bhakti, the practice of directing the heart toward the Divine through meditation, chanting, prayer, puja, and selfless service. Bhakti Marga places a strong emphasis on lived spirituality: developing devotion, cultivating inner transformation, and building supportive communities that help individuals bring spiritual principles into daily life.\n\nActivities include courses on meditation and yoga, deity worship, satsangs, music programs, retreats, seva initiatives, pilgrimages, and large international events such as kirtan festivals and sacred celebrations. Many country groups also maintain local temples or puja halls where regular prayers and rituals are offered.\n\nToday Bhakti Marga is active in more than 40 countries, supported by hundreds of volunteers and practitioners who help maintain temples, organise events, and share the teachings. Its aim remains simple: to guide people toward a loving, personal relationship with the Divine and to support a devotional way of living in modern society.',
            story2: '',
            story3: '',
            valuesTitle: '4 Arms',
            value1Title: 'Yoga & Meditation',
            value1Text: 'Still the mind, find god within',
            value2Title: 'Knowledge',
            value2Text: 'Gain insights and clarity',
            value3Title: 'Rituals',
            value3Text: 'Deepen divine connection',
            value4Title: 'Devotional Arts',
            value4Text: 'Create an expression of love',
            readMore: 'Read more'
        },
        bio: {
            title: 'Bio',
            name: 'Dhanurdhara Das Ananda',
            titleText: 'Teacher of Spiritual Knowledge, Rituals & Atma Kriya Yoga',
            text1: 'Born in July 1994, Dhanurdhara Das Ananda grew up in a religious family, yet he never considered himself a religious person. As a young man, after achieving many of the things he desired, he began to feel an inner emptiness he couldn\'t explain or fill.',
            text2: 'With his long-standing interest in history, politics, and philosophy, he turned his attention toward self-knowledge, God, and the depth of Hindu culture.',
            text3: 'In January 2017, he met Paramahamsa Vishwananda in São Paulo, where he experienced something profound and transformative — an encounter he later understood as a call from his soul to his Satguru.',
            text4: 'In Florianópolis, where he lived, Paramahamsa Vishwananda inaugurated a temple located just ten minutes from his home, which Dhanurdhara began to attend regularly. A year later, he traveled to Germany to Shree Peetha Nilaya, where he dedicated himself to seva (selfless service) and a deeper study of Bhakti Marga and Hinduism.',
            educationTitle: 'Education & Certifications',
            education1: 'Training in Bhakti Yoga and Vedic Philosophy, Bhakti Marga Academy',
            education2: 'Certified Atma Kriya Yoga Teacher',
            education3: 'Training in Vedic Rituals and Spiritual Ceremonies',
            education4: 'Ongoing studies under the guidance of Paramahamsa Vishwananda',
            experienceTitle: 'Experience',
            experienceText: 'With over seven years dedicated to the Bhakti path, Dhanurdhara Das Ananda serves as a teacher and facilitator of spiritual practices, offering classes and talks on Vedic knowledge, rituals, and Atma Kriya Yoga. His work inspires spiritual seekers to cultivate a deeper relationship with the Divine, integrating ancient wisdom with daily devotion and self-discovery.'
        },
        satguru: {
            title: 'Satguru',
            subtitle: 'Paramahamsa Vishwananda',
            text1: 'Paramahamsa Sri Swami Vishwananda (born 13 June 1978 in Beau Bassin–Rose Hill, Mauritius) is a Mauritian-born Hindu spiritual teacher and the founder of Bhakti Marga. His early life is presented by his organisation as steeped in devotion, with a formative encounter with Mahavatar Babaji in childhood—a relationship he describes as the guiding thread of his mission.',
            text2: 'After traveling and giving darshan in Europe in the late 1990s, he formally established Bhakti Marga on 13 June 2005. The movement\'s international headquarters is Shree Peetha Nilaya in Heidenrod (Taunus), Germany, from which he teaches a path of devotion (bhakti), including practices such as Atma Kriya Yoga.',
            text3: 'In recent years, he articulated the Hari Bhakta Sampradaya within which Bhakti Marga operates, and the mission has grown to include temples and centers worldwide.',
            meetHim: 'Meet Him'
        },
        practices: {
            title: 'Our Practices',
            practice1Title: 'Acupuncture',
            practice1Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice2Title: 'Yoga Therapy',
            practice2Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice3Title: 'Reiki Healing',
            practice3Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice4Title: 'Meditation',
            practice4Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice5Title: 'Herbal Medicine',
            practice5Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice6Title: 'Nutrition Counseling',
            practice6Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            learnMore: 'Learn More →'
        },
        booking: {
            title: 'Contact',
            nameLabel: 'Full Name',
            emailLabel: 'Email',
            phoneLabel: 'Phone',
            dateLabel: 'Preferred Date',
            timeLabel: 'Preferred Time',
            messageLabel: 'Message',
            submitButton: 'Send Message'
        },
        footer: {
            text: 'Wellness Center. All rights reserved.'
        },
        messages: {
            bookingSuccess: 'Message sent successfully'
        }
    },
    pt: {
        lang: {
            english: 'English',
            portuguese: 'Português'
        },
        nav: {
            logo: 'Centro de Bem-Estar',
            home: 'Início',
            about: 'Bhakti Marga',
            satguru: 'Satguru',
            bio: 'Biografia',
            practices: 'Práticas',
            contact: 'Contato'
        },
        home: {
            heroTitle: 'Bem-vindo ao Centro de Bem-Estar',
            heroSubtitle: 'Sua jornada para o bem-estar começa aqui',
            getStarted: 'Começar',
            feature1Title: 'Abordagem Holística',
            feature1Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore.',
            feature2Title: 'Métodos Naturais',
            feature2Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore.',
            feature3Title: 'Cuidado Especializado',
            feature3Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore.'
        },
        about: {
            title: 'Bhakti Marga',
            storyTitle: 'Nossa História',
            story1: 'Bhakti Marga começou em 2005 como uma pequena comunidade devocional dedicada a cultivar uma vida baseada no amor, no serviço e na prática espiritual. Com o tempo, tornou-se um movimento global com centros, templos e ashrams distribuídos pela Europa, Américas, África e Ásia. Sua sede internacional, Shree Peetha Nilaya, na Alemanha, funciona como o principal ashram e centro de formação. Outros templos e ashrams estão ativos em países como Portugal, Reino Unido, França, África do Sul, Maurício, Índia, Estados Unidos e Brasil, cada um oferecendo encontros comunitários e programas devocionais regulares.\n\nO caminho se fundamenta no bhakti, a prática de direcionar o coração ao Divino por meio de meditação, canto, oração, puja e serviço altruísta. Bhakti Marga valoriza uma espiritualidade vivida: desenvolver devoção, promover transformação interior e sustentar comunidades que ajudam cada pessoa a aplicar princípios espirituais no dia a dia.\n\nAs atividades incluem cursos de meditação e yoga, adoração às deidades, satsangs, programas musicais, retiros, iniciativas de seva, peregrinações e grandes eventos internacionais como festivais de kirtan e celebrações sagradas. Muitos grupos locais também mantêm templos ou salas de puja com orações e rituais regulares.\n\nHoje, Bhakti Marga está presente em mais de 40 países, sustentada por centenas de voluntários e praticantes que mantêm templos, organizam eventos e compartilham os ensinamentos. Seu propósito permanece simples: apoiar cada pessoa a desenvolver uma relação amorosa e pessoal com o Divino e viver a devoção na sociedade contemporânea.',
            story2: '',
            story3: '',
            valuesTitle: '4 Braços',
            value1Title: 'Yoga e Meditação',
            value1Text: 'Acalme a mente, encontre Deus dentro de si',
            value2Title: 'Conhecimento',
            value2Text: 'Obtenha insights e clareza',
            value3Title: 'Rituais',
            value3Text: 'Aprofunde a conexão divina',
            value4Title: 'Artes Devocionais',
            value4Text: 'Crie uma expressão de amor',
            readMore: 'Leia mais'
        },
        bio: {
            title: 'Biografia',
            name: 'Dhanurdhara Das Ananda',
            titleText: 'Professor de Conhecimento Espiritual, Rituais & Atma Kriya Yoga',
            text1: 'Nascido em julho de 1994, Dhanurdhara Das Ananda cresceu em uma família religiosa, mas nunca se considerou uma pessoa religiosa. Ainda jovem, após conquistar o que desejava materialmente, começou a sentir um vazio interior que não sabia como preencher.',
            text2: 'Movido por um interesse crescente por história, política e filosofia, iniciou uma busca mais profunda por autoconhecimento, espiritualidade e pela compreensão de Deus — caminho que o levou à cultura hindu.',
            text3: 'Em janeiro de 2017, conheceu Paramahamsa Vishwananda em São Paulo. Durante esse encontro, viveu uma experiência profunda e transformadora, que mais tarde reconheceu como um chamado da alma ao seu Satguru.',
            text4: 'Em Florianópolis, cidade onde residia, Paramahamsa Vishwananda inaugurou um templo a apenas dez minutos de sua casa, e Dhanurdhara passou a frequentá-lo regularmente. Um ano depois, viajou à Alemanha, ao ashram Shree Peetha Nilaya, onde se dedicou ao seva (serviço devocional) e ao aprendizado mais profundo sobre Bhakti Marga e o Hinduísmo.',
            educationTitle: 'Educação e Certificações',
            education1: 'Formação em Bhakti Yoga e Filosofia Védica, Bhakti Marga Academy',
            education2: 'Instrutor Certificado de Atma Kriya Yoga',
            education3: 'Formação em Rituais Védicos e Cerimônias Espirituais',
            education4: 'Estudos contínuos sob a orientação de Paramahamsa Vishwananda',
            experienceTitle: 'Experiência',
            experienceText: 'Com mais de sete anos dedicados ao caminho do Bhakti, Dhanurdhara Das Ananda atua como professor e facilitador de práticas espirituais, conduzindo aulas e palestras sobre conhecimento védico, rituais e Atma Kriya Yoga. Seu trabalho inspira buscadores espirituais a desenvolver uma relação mais profunda com o Divino, unindo sabedoria ancestral e prática devocional no cotidiano.'
        },
        satguru: {
            title: 'Satguru',
            subtitle: 'Paramahamsa Vishwananda',
            text1: 'Paramahamsa Sri Swami Vishwananda (nascido em 13 de junho de 1978, em Beau Bassin–Rose Hill, Maurício) é um mestre espiritual hindu nascido no Maurício e fundador da Bhakti Marga. Sua organização apresenta sua infância como profundamente devocional, marcada por um encontro formativo com Mahavatar Babaji — relação que ele descreve como o fio condutor de sua missão.',
            text2: 'Após viajar e oferecer darshan na Europa no fim dos anos 1990, ele fundou oficialmente a Bhakti Marga em 13 de junho de 2005. A sede internacional do movimento é Shree Peetha Nilaya, em Heidenrod (Taunus), Alemanha, de onde ele ensina um caminho de devoção (bhakti), incluindo práticas como Atma Kriya Yoga.',
            text3: 'Nos últimos anos, ele apresentou a Hari Bhakta Sampradaya, dentro da qual a Bhakti Marga opera, e a missão tem se expandido, passando a incluir templos e centros no mundo todo.',
            meetHim: 'O Encontre'
        },
        practices: {
            title: 'Nossas Práticas',
            practice1Title: 'Acupuntura',
            practice1Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice2Title: 'Terapia de Yoga',
            practice2Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice3Title: 'Cura Reiki',
            practice3Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice4Title: 'Meditação',
            practice4Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice5Title: 'Medicina Herbal',
            practice5Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            practice6Title: 'Aconselhamento Nutricional',
            practice6Text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.',
            learnMore: 'Saiba Mais →'
        },
        booking: {
            title: 'Contato',
            nameLabel: 'Nome Completo',
            emailLabel: 'Email',
            phoneLabel: 'Telefone',
            dateLabel: 'Data Preferida',
            timeLabel: 'Horário Preferido',
            messageLabel: 'Mensagem',
            submitButton: 'Enviar Mensagem'
        },
        footer: {
            text: 'Centro de Bem-Estar. Todos os direitos reservados.'
        },
        messages: {
            bookingSuccess: 'Mensagem enviada com sucesso'
        }
    }
};

// Current language
let currentLang = localStorage.getItem('language') || 'en';

// Translation function
function translate(key) {
    const keys = key.split('.');
    let value = translations[currentLang];
    for (const k of keys) {
        value = value?.[k];
    }
    return value || key;
}

// Update page language
function updateLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('language', lang);
    document.documentElement.lang = lang;
    
    // Update all elements with data-translate attribute
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        const translation = translate(key);
        
        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
            element.placeholder = translation;
        } else if (element.tagName === 'OPTION') {
            element.textContent = translation;
        } else if (element.tagName === 'P') {
            // Convert newlines to <br> tags for paragraphs
            element.innerHTML = translation.replace(/\n\n/g, '<br><br>').replace(/\n/g, '<br>');
        } else if (element.tagName === 'LABEL') {
            // For labels, check if associated input is required and add asterisk
            const inputId = element.getAttribute('for');
            if (inputId) {
                const input = document.getElementById(inputId);
                if (input && input.hasAttribute('required')) {
                    element.innerHTML = translation + ' <span class="required">*</span>';
                } else {
                    element.textContent = translation;
                }
            } else {
                element.textContent = translation;
            }
        } else {
            element.textContent = translation;
        }
    });
    
    // Update language dropdown display
    const dropdown = document.getElementById('language-dropdown');
    const selectedDisplay = document.getElementById('dropdown-selected');
    if (dropdown && selectedDisplay) {
        const selectedOption = dropdown.querySelector(`[data-lang="${lang}"]`);
        if (selectedOption) {
            const flag = selectedOption.querySelector('.flag').textContent;
            const langName = selectedOption.querySelector('.lang-name').textContent;
            selectedDisplay.querySelector('.flag').textContent = flag;
            selectedDisplay.querySelector('.lang-name').textContent = langName;
        }
    }
}

// Smooth scroll fallback function
function smoothScrollTo(target, duration) {
    const start = window.pageYOffset;
    const distance = target - start;
    let startTime = null;

    function easeInOutCubic(t) {
        return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
    }

    function animation(currentTime) {
        if (startTime === null) startTime = currentTime;
        const timeElapsed = currentTime - startTime;
        const progress = Math.min(timeElapsed / duration, 1);
        const ease = easeInOutCubic(progress);
        
        window.scrollTo(0, start + distance * ease);
        
        if (timeElapsed < duration) {
            requestAnimationFrame(animation);
        }
    }

    requestAnimationFrame(animation);
}

// Navigation functionality
document.addEventListener('DOMContentLoaded', function() {
    const navLinks = document.querySelectorAll('.nav-link');
    const pages = document.querySelectorAll('.page');
    const hamburger = document.querySelector('.hamburger');
    const navMenu = document.querySelector('.nav-menu');

    // Logo element
    const headerLogo = document.getElementById('header-logo');
    
    // Function to update logo based on active page
    function updateLogo(activePageId) {
        if (headerLogo) {
            if (activePageId === 'about') {
                // Bhakti Marga tab - use blue logo
                headerLogo.src = 'img/ddd-blue-logo.png';
            } else {
                // All other tabs - use default logo
                headerLogo.src = 'img/ddd-logo.png';
            }
        }
    }

    // Handle navigation clicks
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            
            // Remove active class from all links and pages
            navLinks.forEach(l => l.classList.remove('active'));
            pages.forEach(p => p.classList.remove('active'));
            
            // Add active class to clicked link and target page
            this.classList.add('active');
            const targetPage = document.getElementById(targetId);
            if (targetPage) {
                targetPage.classList.add('active');
                
                // Update logo based on active page
                updateLogo(targetId);
                
                // Smooth scroll to top with easing
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
                
                // Fallback for browsers that don't support smooth scroll
                if (!('scrollBehavior' in document.documentElement.style)) {
                    smoothScrollTo(0, 500);
                }
            }
            
            // Close mobile menu
            navMenu.classList.remove('active');
        });
    });

    // Hamburger menu toggle
    hamburger.addEventListener('click', function() {
        navMenu.classList.toggle('active');
        this.classList.toggle('active');
    });

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(e) {
        if (!hamburger.contains(e.target) && !navMenu.contains(e.target)) {
            navMenu.classList.remove('active');
            hamburger.classList.remove('active');
        }
    });

    // Set initial active page based on hash or default to home
    const hash = window.location.hash.substring(1);
    if (hash && document.getElementById(hash)) {
        navLinks.forEach(l => l.classList.remove('active'));
        pages.forEach(p => p.classList.remove('active'));
        document.querySelector(`a[href="#${hash}"]`).classList.add('active');
        document.getElementById(hash).classList.add('active');
        updateLogo(hash);
    } else {
        // Default to home page logo
        updateLogo('home');
    }

    // Handle browser back/forward buttons
    window.addEventListener('hashchange', function() {
        const hash = window.location.hash.substring(1);
        if (hash && document.getElementById(hash)) {
            navLinks.forEach(l => l.classList.remove('active'));
            pages.forEach(p => p.classList.remove('active'));
            document.querySelector(`a[href="#${hash}"]`).classList.add('active');
            document.getElementById(hash).classList.add('active');
            updateLogo(hash);
        } else {
            updateLogo('home');
        }
    });

    // Form submission
    // EmailJS Configuration
    // To set up EmailJS:
    // 1. Sign up for free at https://www.emailjs.com/
    // 2. Go to Email Services and add your email service (Gmail, Outlook, etc.)
    // 3. Go to Email Templates and create a new template with variables: {{from_name}}, {{from_email}}, {{message}}
    // 4. Go to Account > API Keys and copy your Public Key
    // 5. Replace the values below with your actual IDs
    
    const EMAILJS_CONFIG = {
        PUBLIC_KEY: "004uXZyZWr4V1_wSk",      // EmailJS Public Key
        SERVICE_ID: "service_wzm5n78",       // Email Service ID
        TEMPLATE_ID: "template_ertyu673mmnd8"      // Email Template ID
    };

    // reCAPTCHA Configuration
    const RECAPTCHA_CONFIG = {
        SITE_KEY: "6Lf4ZiAsAAAAAG7JVAuVTY0Pn63Kyn6jN47VBlCc"  // reCAPTCHA Site Key
    };

    // Initialize EmailJS - wait for library to load
    function initializeEmailJS() {
        if (typeof emailjs !== 'undefined') {
            emailjs.init(EMAILJS_CONFIG.PUBLIC_KEY);
            console.log('EmailJS initialized');
        } else {
            // Retry if library not loaded yet
            setTimeout(initializeEmailJS, 100);
        }
    }
    
    // Start initialization
    initializeEmailJS();

    const bookingForm = document.querySelector('.booking-form');
    if (bookingForm) {
        bookingForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Check if EmailJS is loaded and initialized
            if (typeof emailjs === 'undefined') {
                alert('Email service is loading. Please wait a moment and try again.');
                return;
            }
            
            // Check if EmailJS is configured
            if (EMAILJS_CONFIG.PUBLIC_KEY === "YOUR_PUBLIC_KEY" || 
                EMAILJS_CONFIG.SERVICE_ID === "YOUR_SERVICE_ID" || 
                EMAILJS_CONFIG.TEMPLATE_ID === "YOUR_TEMPLATE_ID") {
                alert('Email service is not configured. Please contact the website administrator.');
                return;
            }
            
            // Check if reCAPTCHA is configured
            if (RECAPTCHA_CONFIG.SITE_KEY === "YOUR_SITE_KEY") {
                // reCAPTCHA not configured - proceed without it
                submitForm(this);
                return;
            }
            
            // Execute reCAPTCHA
            const form = this;
            if (typeof grecaptcha !== 'undefined') {
                grecaptcha.ready(function() {
                    grecaptcha.execute(RECAPTCHA_CONFIG.SITE_KEY, {action: 'submit'})
                        .then(function(token) {
                            // reCAPTCHA verified - submit form
                            submitForm(form, token);
                        })
                        .catch(function(error) {
                            console.error('reCAPTCHA error:', error);
                            alert('reCAPTCHA verification failed. Please try again.');
                        });
                });
            } else {
                // reCAPTCHA not loaded - proceed without it
                submitForm(form);
            }
        });
    }

    // Form submission function
    function submitForm(form, recaptchaToken = null) {
        // Get form data
        const formData = new FormData(form);
        const data = {
            from_name: formData.get('name'),
            from_email: formData.get('email'),
            message: formData.get('message')
        };
        
        // Add reCAPTCHA token if available
        if (recaptchaToken) {
            data['g-recaptcha-response'] = recaptchaToken;
        }
        
        // Show loading state
        const submitButton = form.querySelector('button[type="submit"]');
        const originalButtonText = submitButton.textContent;
        submitButton.disabled = true;
        submitButton.textContent = 'Sending...';
        
        // Send email using EmailJS
        emailjs.send(EMAILJS_CONFIG.SERVICE_ID, EMAILJS_CONFIG.TEMPLATE_ID, data)
                .then(function(response) {
                    // Success
                    console.log('Email sent successfully!', response.status, response.text);
                    
                    // Show success message with form data
                    const successModal = document.getElementById('success-message');
                    const successName = document.getElementById('success-name');
                    const successEmail = document.getElementById('success-email');
                    const successMessageText = document.getElementById('success-message-text');
                    
                    if (successModal && successName && successEmail && successMessageText) {
                        successName.textContent = data.from_name;
                        successEmail.textContent = data.from_email;
                        successMessageText.textContent = data.message;
                        successModal.style.display = 'flex';
                        
                        // Update translations in success modal
                        updateLanguage(currentLang);
                    }
                    
                    form.reset();
                    submitButton.disabled = false;
                    submitButton.textContent = originalButtonText;
                }, function(error) {
                    // Error - show detailed error
                    console.error('EmailJS error details:', error);
                    console.error('Error status:', error.status);
                    console.error('Error text:', error.text);
                    let errorMessage = 'Sorry, there was an error sending your message. ';
                    if (error.text) {
                        errorMessage += 'Error: ' + error.text;
                    }
                    alert(errorMessage);
                    submitButton.disabled = false;
                    submitButton.textContent = originalButtonText;
                });
    }

    // Add scroll effect to navbar
    let lastScroll = 0;
    const navbar = document.querySelector('.navbar');
    
    window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 100) {
            navbar.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.15)';
        } else {
            navbar.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.1)';
        }
        
        lastScroll = currentScroll;
    });

    // Intersection Observer for fade-in animations on scroll
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // Observe elements for scroll animations
    const animateElements = document.querySelectorAll('.feature-card, .practice-card, .value-item');
    animateElements.forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px)';
        el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(el);
    });

    // Smooth reveal for images
    const images = document.querySelectorAll('img');
    images.forEach(img => {
        img.addEventListener('load', function() {
            this.style.opacity = '1';
        });
    });

    // Custom language dropdown functionality
    const dropdown = document.getElementById('language-dropdown');
    const selectedDisplay = document.getElementById('dropdown-selected');
    const dropdownOptions = document.getElementById('dropdown-options');
    
    if (dropdown && selectedDisplay && dropdownOptions) {
        // Toggle dropdown on click
        selectedDisplay.addEventListener('click', function(e) {
            e.stopPropagation();
            dropdown.classList.toggle('active');
        });
        
        // Handle option selection
        const options = dropdownOptions.querySelectorAll('.dropdown-option');
        options.forEach(option => {
            option.addEventListener('click', function(e) {
                e.stopPropagation();
                const lang = this.getAttribute('data-lang');
                updateLanguage(lang);
                dropdown.classList.remove('active');
            });
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!dropdown.contains(e.target)) {
                dropdown.classList.remove('active');
            }
        });
    }

    // Initialize language on page load
    updateLanguage(currentLang);

    // Satguru Carousel functionality
    const satguruCarousel = document.querySelector('.satguru-carousel-container');
    if (satguruCarousel) {
        const carouselTrack = satguruCarousel.querySelector('.carousel-track');
        const carouselSlides = satguruCarousel.querySelectorAll('.carousel-slide');
        const prevBtn = satguruCarousel.querySelector('.carousel-btn-prev');
        const nextBtn = satguruCarousel.querySelector('.carousel-btn-next');
        const dots = satguruCarousel.querySelectorAll('.carousel-dot');
        
        if (carouselTrack && carouselSlides.length > 0) {
            let currentIndex = 0;
            const totalSlides = carouselSlides.length;
            
            function getVisibleSlidesCount() {
                // Calculate how many slides fit in the viewport
                const containerWidth = carouselTrack.parentElement.offsetWidth;
                const gap = 16; // 1rem gap
                let totalWidth = 0;
                let count = 0;
                
                for (let i = 0; i < totalSlides; i++) {
                    const slideWidth = carouselSlides[i].offsetWidth;
                    if (totalWidth + slideWidth + (count > 0 ? gap : 0) <= containerWidth) {
                        totalWidth += slideWidth + (count > 0 ? gap : 0);
                        count++;
                    } else {
                        break;
                    }
                }
                return Math.max(1, count); // At least show 1 slide
            }
            
            function updateCarousel() {
                // Calculate translateX based on actual slide positions
                let translateX = 0;
                const gap = 16; // 1rem gap
                
                for (let i = 0; i < currentIndex && i < totalSlides; i++) {
                    translateX += carouselSlides[i].offsetWidth + gap;
                }
                
                carouselTrack.style.transform = `translateX(-${translateX}px)`;
                
                // Update dots based on current position
                const visibleCount = getVisibleSlidesCount();
                const maxIndex = Math.max(0, totalSlides - visibleCount);
                const dotIndex = Math.floor((currentIndex / totalSlides) * dots.length);
                
                dots.forEach((dot, index) => {
                    dot.classList.toggle('active', index === dotIndex);
                });
            }
            
            function nextSlide() {
                const visibleCount = getVisibleSlidesCount();
                const maxIndex = Math.max(0, totalSlides - visibleCount);
                
                if (currentIndex < maxIndex) {
                    // Move forward by approximately one visible group
                    currentIndex = Math.min(currentIndex + visibleCount, maxIndex);
                } else {
                    currentIndex = 0; // Loop back to start
                }
                updateCarousel();
            }
            
            function prevSlide() {
                const visibleCount = getVisibleSlidesCount();
                
                if (currentIndex > 0) {
                    // Move backward by approximately one visible group
                    currentIndex = Math.max(0, currentIndex - visibleCount);
                } else {
                    const maxIndex = Math.max(0, totalSlides - visibleCount);
                    currentIndex = maxIndex; // Loop to end
                }
                updateCarousel();
            }
            
            function goToSlide(dotIndex) {
                // Calculate position based on dot index
                const maxIndex = Math.max(0, totalSlides - getVisibleSlidesCount());
                currentIndex = Math.floor((dotIndex / dots.length) * totalSlides);
                if (currentIndex > maxIndex) {
                    currentIndex = maxIndex;
                }
                updateCarousel();
            }
            
            // Event listeners
            if (nextBtn) {
                nextBtn.addEventListener('click', nextSlide);
            }
            
            if (prevBtn) {
                prevBtn.addEventListener('click', prevSlide);
            }
            
            // Dot navigation
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => goToSlide(index));
            });
            
            // Touch/swipe support for mobile
            let startX = 0;
            let endX = 0;
            
            carouselTrack.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
            });
            
            carouselTrack.addEventListener('touchend', (e) => {
                endX = e.changedTouches[0].clientX;
                handleSwipe();
            });
            
            function handleSwipe() {
                const diff = startX - endX;
                if (Math.abs(diff) > 50) { // Minimum swipe distance
                    if (diff > 0) {
                        nextSlide();
                    } else {
                        prevSlide();
                    }
                }
            }
            
            // Recalculate on window resize
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    const visibleCount = getVisibleSlidesCount();
                    const maxIndex = Math.max(0, totalSlides - visibleCount);
                    if (currentIndex > maxIndex) {
                        currentIndex = maxIndex;
                    }
                    updateCarousel();
                }, 250);
            });
            
            // Wait for images to load before initializing
            const images = carouselTrack.querySelectorAll('img');
            let imagesLoaded = 0;
            
            if (images.length > 0) {
                images.forEach(img => {
                    if (img.complete) {
                        imagesLoaded++;
                    } else {
                        img.addEventListener('load', () => {
                            imagesLoaded++;
                            if (imagesLoaded === images.length) {
                                updateCarousel();
                            }
                        });
                    }
                });
                
                if (imagesLoaded === images.length) {
                    updateCarousel();
                }
            } else {
                updateCarousel();
            }
        }
    }
});

